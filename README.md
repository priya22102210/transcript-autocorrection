Sure! Here's a documentation for the provided code:

# Transcription Correction API

This is a Flask-based API for correcting transcriptions generated by AWS Transcribe. It takes an AWS Transcribe transcript and a reference document as input and generates a corrected transcript by aligning the reference document with the AWS Transcribe timestamps.

## Installation

1. Clone the repository from GitHub:

   ```
   git clone <repository_url>
   ```

2. Install the required dependencies using pip:

   ```
   pip install flask flask_cors
   ```

## Usage

1. Import the necessary modules:

   ```
   from flask import Flask, request, jsonify
   from flask_cors import CORS, cross_origin
   import re
   ```

2. Create an instance of the Flask application:

   ```
   app = Flask(__name__)
   CORS(app)
   ```

3. Define the index route:

   ```
   @app.route('/', methods=['GET'])
   def index():
       return 'Hello, world!'
   ```

   This route simply returns a greeting message when you visit the root URL.

4. Define the 'gen-transcript' route:

   ```
   @app.route('/gen-transcript', methods=['POST'])
   def gen_transcript():
       data = request.get_json()
       aws_transcript = data.get('aws_transcript')
       reference_document = data.get('reference_document')
       corrected_transcript = autocorrect_transcript(aws_transcript, reference_document)
       return jsonify(corrected_transcript)
   ```

   This route is responsible for handling POST requests to '/gen-transcript'. It expects a JSON payload with two keys: 'aws_transcript' (the AWS Transcribe transcript) and 'reference_document' (the reference document). It calls the `autocorrect_transcript` function to generate the corrected transcript and returns it as a JSON response.

5. Implement the `autocorrect_transcript` function:

   ```
   def autocorrect_transcript(aws_transcript, reference_document):
       aws_blocks = re.findall(r"(\d+)\n(\d{2}:\d{2}:\d{2}\.\d{3}) --> (\d{2}:\d{2}:\d{2}\.\d{3})\n(.*?)\n\n", aws_transcript, re.DOTALL)
       corrected_transcript = []
       ref_lines = reference_document.splitlines()

       ref_index = 0
       for line_number, aws_start_time, aws_end_time, aws_text in aws_blocks:
           while ref_index < len(ref_lines) and not ref_lines[ref_index]:
               # Skip empty reference lines
               ref_index += 1

           ref_line = ref_lines[ref_index] if ref_index < len(ref_lines) else ''

           corrected_line = f"{line_number}\n{aws_start_time} --> {aws_end_time}\n{ref_line}"
           corrected_transcript.append(corrected_line)

           ref_index += 1

       # Insert empty lines for the remaining reference lines
       while ref_index < len(ref_lines):
           while ref_index < len(ref_lines) and not ref_lines[ref_index]:
               # Skip empty reference lines
               ref_index += 1

           if ref_index < len(ref_lines):
               corrected_line = f"{ref_index+1}\n\n{ref_lines[ref_index]}"
               corrected_transcript.append(corrected_line)

               ref_index += 1

       return '\n\n'.join(corrected_transcript)
   ```

   This function takes the AWS Transcribe transcript and reference document as input and performs the following steps:
   - Extracts the blocks from the AWS Transcribe transcript using regular expressions.
   - Splits the reference document into lines.
   - Iterates over each block and aligns it with the corresponding reference line, skipping empty reference lines.
   - Appends the corrected lines to the `corrected_transcript` list.
   - Inserts empty lines for any remaining reference lines.
   - Returns the joined corrected transcript as a string.

6. Start the Flask development server:

   ```
   if __name__ == '__main__':
       app.run(debug=True)
   ```

   This starts the Flask development server, allowing you to test the API locally.

7. Upload the code to GitHub:

   - Create a new repository on GitHub.
   - Push the cloned repository to the newly created repository on GitHub.

## Testing

To test the API, you can use tools like cURL or Postman to send a POST request to the '/gen-transcript' endpoint with the following JSON payload:

```
{
  "aws_transcript": "<aws_transcript_content>",
  "reference_document": "<reference_document_content>"
}
```

Replace `<aws_transcript_content>` with the actual AWS Transcribe transcript content and `<reference_document_content>` with the actual reference document content.

The API will return the corrected transcript as a JSON response.

Note: Make sure to provide valid AWS Transcribe and reference document inputs for accurate results.

That's it! You now have the documentation for the provided code. Feel free to upload it to GitHub for sharing and collaboration.
